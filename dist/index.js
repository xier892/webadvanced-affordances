"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=n.length;return function(o){if("function"!=typeof o&&("object"!==_typeof(o)||null===o))throw new TypeError("Object.keys called on non-object");var i,r,l=[];for(i in o)e.call(o,i)&&l.push(i);if(t)for(r=0;r<a;r++)e.call(o,n[r])&&l.push(n[r]);return l}}()),Object.values=Object.values?Object.values:function(e){var t=Object.prototype.toString.call(e);if(null===e||void 0===e)throw new TypeError("Cannot convert undefined or null to object");if(~["[object String]","[object Object]","[object Array]","[object Function]"].indexOf(t)){if(Object.keys)return Object.keys(e).map(function(t){return e[t]});var n=[];for(var a in e)e.hasOwnProperty(a)&&n.push(e[a]);return n}return[]},function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(0,function(){function e(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){return t.reject(n)})})}function t(e){return!(!e||void 0===e.length)}function n(){}function a(e){if(!(this instanceof a))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(e,this)}function o(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,a._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var a;try{a=n(e._value)}catch(e){return void r(t.promise,e)}i(t.promise,a)}else(1===e._state?i:r)(t.promise,e._value)})):e._deferreds.push(t)}function i(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==_typeof(t)||"function"==typeof t)){var n=t.then;if(t instanceof a)return e._state=3,e._value=t,void l(e);if("function"==typeof n)return void c(function(e,t){return function(){e.apply(t,arguments)}}(n,t),e)}e._state=1,e._value=t,l(e)}catch(t){r(e,t)}}function r(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&a._immediateFn(function(){e._handled||a._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;n>t;t++)o(e,e._deferreds[t]);e._deferreds=null}function c(e,t){var n=!1;try{e(function(e){n||(n=!0,i(t,e))},function(e){n||(n=!0,r(t,e))})}catch(e){if(n)return;n=!0,r(t,e)}}var s=setTimeout;a.prototype.catch=function(e){return this.then(null,e)},a.prototype.then=function(e,t){var a=new this.constructor(n);return o(this,new function(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(e,t,a)),a},a.prototype.finally=e,a.all=function(e){return new a(function(n,a){function o(e,t){try{if(t&&("object"==_typeof(t)||"function"==typeof t)){var l=t.then;if("function"==typeof l)return void l.call(t,function(t){o(e,t)},a)}i[e]=t,0==--r&&n(i)}catch(e){a(e)}}if(!t(e))return a(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(e);if(0===i.length)return n([]);for(var r=i.length,l=0;i.length>l;l++)o(l,i[l])})},a.resolve=function(e){return e&&"object"==_typeof(e)&&e.constructor===a?e:new a(function(t){t(e)})},a.reject=function(e){return new a(function(t,n){n(e)})},a.race=function(e){return new a(function(n,o){if(!t(e))return o(new TypeError("Promise.race accepts an array"));for(var i=0,r=e.length;r>i;i++)a.resolve(e[i]).then(n,o)})},a._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){s(e,0)},a._unhandledRejectionFn=function(e){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var u=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("unable to locate global object")}();"Promise"in u?u.Promise.prototype.finally||(u.Promise.prototype.finally=e):u.Promise=a}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){null!==this.parentNode&&this.parentNode.removeChild(this)}})});var whichAnimationEvent=function(){for(var e=document.createElement("fakeelement"),t={animation:"animationend",OAnimation:"oTransitionEnd",MozAnimation:"animationend",WebkitAnimation:"webkitTransitionEnd"},n=0;n<Object.keys(t).length;n++)if(void 0!==e.style[Object.keys(t)[n]])return Object.values(t)[n]},animationend=whichAnimationEvent(),promiseAnimationEnd=function(e){return new Promise(function(t){e.addEventListener(animationend,t)})},whichTransitionEvent=function(){for(var e=document.createElement("fakeelement"),t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"},n=0;n<Object.keys(t).length;n++)if(void 0!==e.style[Object.keys(t)[n]])return Object.values(t)[n]},transitionend=whichTransitionEvent(),promiseTransitionEnd=function(e){return new Promise(function(t){e.addEventListener(transitionend,t)})},getRandomInt=function(e,t){return Math.floor(Math.random()*(Math.floor(t)-Math.ceil(e)))+Math.ceil(e)},getSizeOfElement=function(e,t){var n,a=document.createElement("div");switch(a.className=e,a.style.visibility="hidden",a.style.position="absolute",document.body.appendChild(a),t){case"width":n=a.getBoundingClientRect().width;break;case"height":n=a.getBoundingClientRect().height;break;default:n=a.getBoundingClientRect().width}return a.remove(),n},getWidthOfElement=function(e){return getSizeOfElement(e,"width")},getHeightOfElement=function(e){return getSizeOfElement(e,"height")},storageAvailable=function(e){var t;try{t=window[e];var n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}},populateStorage=function(e,t){storageAvailable("localStorage")&&localStorage.setItem(e,t)},retrieveStorage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return storageAvailable("localStorage")?localStorage.getItem(e):t},removeStorage=function(e){storageAvailable("localStorage")&&localStorage.removeItem(e)},setMaximumCapacity=function(){return Math.ceil(window.screen.availWidth/getWidthOfElement("pill transformedWidthTest")*(.8*document.documentElement.offsetHeight/getWidthOfElement("pill transformedWidthTest")))},SETTINGS={PRESCRIPTION_DOSE_MIN:1,PRESCRIPTION_DOSE_MAX:5,PRESCRIPTION_QTY_MIN:1,PRESCRIPTION_QTY_MAX:setMaximumCapacity()};window.addEventListener("contextmenu",function(e){e.preventDefault()}),window.addEventListener("resize",function(){SETTINGS.PRESCRIPTION_QTY_MAX=setMaximumCapacity()});var prescription={};SETTINGS.DEFAULT_PRESCRIPTION=JSON.stringify({quantity:Math.min(15,SETTINGS.PRESCRIPTION_QTY_MAX),dose:1}),retrieveStorage("prescription")||populateStorage("prescription",SETTINGS.DEFAULT_PRESCRIPTION);var updatePrescription=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.quantity,a=e.dose,o=t.skipValidation,i=SETTINGS.DEFAULT_PRESCRIPTION,r=SETTINGS.PRESCRIPTION_DOSE_MIN,l=SETTINGS.PRESCRIPTION_DOSE_MAX,c=SETTINGS.PRESCRIPTION_QTY_MIN,s=SETTINGS.PRESCRIPTION_QTY_MAX,u=JSON.parse(i);o?(prescription.dose=a,prescription.quantity=n):(prescription.dose=a<r?r:a>s?s:a>=r&&a<=l?Math.max(Math.round(a),r):u.dose,prescription.quantity=n<c?c:n>s?s:n>=c&&n<=s?Math.max(prescription.dose,Math.round(n)):u.quantity),populateStorage("prescription",JSON.stringify(prescription))};updatePrescription(JSON.parse(retrieveStorage("prescription",SETTINGS.DEFAULT_PRESCRIPTION)),{skipValidation:!0});var bottle={el:document.getElementById("bottle"),state:{capacity:"full"},setOpenState:function(e){bottle.state.capacity="fromStorage"===e?retrieveStorage("pillCount")>0?"full":"empty":pillCollection.count()>0?"full":"empty"},prepare:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();switch(bottle.setOpenState(),bottle.state.capacity){case"empty":buttonTake.toggle(e),label.toggleInput("enable"),e.then(function(){label.toggle("show",150)});break;case"full":buttonRefill.toggle()}},empty:function(){bottle.el.classList.add("flipped"),pillCollection.take(pillCollection.count()).then(function(){promiseTransitionEnd(bottle.el).then(function(){setTimeout(function(){bottle.el.classList.remove("flipped")},300)})})},init:function(){bottle.setOpenState("fromStorage")}};bottle.init();var cap={properties:{},state:{},setOpenState:function(e){cap.state.open="open"===e,populateStorage("capState",e)},depress:function(){cap.state.action="depressed",cap.el.classList.add("pressed")},move:function(){cap.state.action="dragging",cap.el.classList.add("dragging")},reset:function(){delete cap.state.action,cap.el.classList.remove("pressed","dragging"),cap.el.removeAttribute("style")},remove:function(){cap.state.action="dragged",cap.el.classList.add("dragged"),cap.setOpenState("open")},replace:function(){delete cap.state.action,cap.el.classList.remove("dragged"),cap.setOpenState("closed")},addEvents:function(){var e=cap.el,t=cap.properties,n=cap.state,a=cap.depress,o=cap.move,i=cap.reset,r=cap.remove,l=(cap.replace,t.width),c=t.height,s=n.timer,u=n.clientX,d=n.clientY,p=n.deltaX,f=n.deltaY;window.addEventListener("resize",function(){l=e.offsetWidth,c=e.offsetHeight}),e.addEventListener("touchstart",function(e){var t=e.touches;e.preventDefault(),u=t[0].clientX,d=t[0].clientY,s=setTimeout(a,250)},!1),e.addEventListener("touchmove",function(e){var t=e.target,a=e.touches;if(s&&clearTimeout(s),"depressed"===n.action||"dragging"===n.action){o(),p=a[0].clientX-u,f=a[0].clientY-d;var i=Math.max(-f/l,p/l);t.style.setProperty("--cap-rotate","".concat(i>0?Math.max(0,80*i):0,"deg")),t.style.setProperty("--cap-translate","".concat(f<0?Math.max(-40,f/4):0,"%"))}},!1),e.addEventListener("touchend",function(e){s&&clearTimeout(s),("dragging"===n.action&&p>=l/2.5||-f>=c/2.5)&&r(),i(),p=0,f=0},!1),e.addEventListener("touchcancel",function(e){s&&clearTimeout(s),i()},!1)},data:function(){var e=document.createElement("div");e.className="cap";for(var t=document.createDocumentFragment(),n=0;n<=12;n++){var a=document.createElement("div");a.className="cap-indent",t.appendChild(a)}return e.appendChild(t),e},init:function(){switch(cap.el=cap.data(),retrieveStorage("capState")){case"open":cap.remove();break;case"closed":break;default:cap.remove()}document.getElementById("top").appendChild(cap.el),cap.properties.width=cap.el.offsetWidth,cap.properties.height=cap.el.offsetHeight,cap.addEvents()}};cap.init();var capunder={data:function(){var e=document.createElement("section");return e.className="capunder",e},init:function(){capunder.el=capunder.data(),document.getElementById("top").appendChild(capunder.el)}};capunder.init();var capunderAction={data:function(){var e=document.createElement("div");return e.className="capunder-action",e},init:function(){capunderAction.el=capunderAction.data(),capunder.el.appendChild(capunderAction.el)}},buttonClose={addEvents:function(){buttonClose.el.addEventListener("touchend",cap.replace,!1)},data:function(){var e=document.createElement("button");e.className="capunder-close",e.type="button",e.name="close";var t=document.createElement("img");return t.src="dist/assets/image/open-collapse-down.svg",t.alt="close",e.appendChild(t),e},init:function(){buttonClose.el=buttonClose.data(),buttonClose.addEvents(),capunder.el.appendChild(buttonClose.el)}};buttonClose.init();var rangeTake={state:{open:!1},properties:{},toggle:function(e){var t=rangeTake.state.open;switch("open"===e?t=!1:"close"===e&&(t=!0),t){case!1:rangeTake.state.open=!0,rangeTake.slider.value=prescription.dose,rangeTake.setProgressBar(),rangeTake.setLabelText(),rangeTake.el.classList.add("open"),rangeTake.el.focus();break;case!0:rangeTake.state.open=!1,buttonTake.resetToOriginalDose(),rangeTake.el.classList.remove("open")}},setProgressBar:function(){var e=rangeTake.properties.width,t=rangeTake.slider,n=e/(SETTINGS.PRESCRIPTION_DOSE_MAX-SETTINGS.PRESCRIPTION_DOSE_MIN);t.style.setProperty("--progress-width","".concat(n*(t.value-SETTINGS.PRESCRIPTION_DOSE_MIN),"px"))},setLabelText:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rangeTake.slider.value,t=rangeTake.label;t.firstChild;)t.removeChild(t.firstChild);Number(e)!==prescription.dose?t.classList.add("warning"):t.classList.remove("warning"),t.appendChild(document.createTextNode(e))},addEvents:function(){var e=rangeTake.el,t=rangeTake.slider,n=(rangeTake.label,rangeTake.state),a=rangeTake.properties,o=rangeTake.toggle,i=rangeTake.setProgressBar,r=rangeTake.setLabelText;window.addEventListener("resize",function(){a.width=t.offsetWidth},!1),t.addEventListener("touchmove",function(){i(),r()},!1),t.addEventListener("touchend",function(){i(),r(),n.open?buttonTake.ignoreRecommendedDose(t.value):buttonTake.resetToOriginalDose()},!1),e.addEventListener("focusout",function(){o("close")},!1)},data:function(){var e=document.createElement("div");e.className="capunder-range-container",e.tabIndex="-1";var t=document.createElement("input");t.className="capunder-range",t.type="range",t.name="takerange",t.value=prescription.dose,t.setAttribute("min",SETTINGS.PRESCRIPTION_DOSE_MIN),t.setAttribute("max",SETTINGS.PRESCRIPTION_DOSE_MAX);var n=document.createElement("label");return n.className="capunder-range-label",n.setAttribute("for","takerange"),{el:e,slider:t,label:n}},init:function(){var e=rangeTake.setProgressBar,t=rangeTake.setLabelText,n=rangeTake.addEvents,a=rangeTake.data;rangeTake.el=a().el,rangeTake.slider=a().slider,rangeTake.label=a().label,t(),e(),n(),rangeTake.el.appendChild(rangeTake.slider),rangeTake.el.appendChild(rangeTake.label),capunderAction.el.appendChild(rangeTake.el),rangeTake.properties.width=rangeTake.slider.offsetWidth}},buttonRefill={toggle:function(){var e=buttonRefill.el;document.body.contains(e)&&(e.remove(),buttonTake.init("disabled"),rangeTake.init())},addEvents:function(){buttonRefill.el.addEventListener("touchend",pillCollection.refill,!1)},removeEvents:function(){buttonRefill.el.removeEventListener("touchend",pillCollection.refill,!1)},data:function(){var e=document.createElement("button");e.className="capunder-refill",e.type="button",e.name="refill";var t=document.createDocumentFragment(),n=document.createElement("img");return n.src="dist/assets/image/material-arrow-drop-down.svg",n.alt="down arrow",t.appendChild(document.createTextNode("refill")),t.appendChild(document.createTextNode(" ")),t.appendChild(n),e.appendChild(t),e},init:function(){buttonRefill.el=buttonRefill.data(),buttonRefill.addEvents(),capunderAction.el.appendChild(buttonRefill.el)}},buttonTake={state:{},toggle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve(),t=buttonTake.el;t.disabled=!0,rangeTake.toggle("close"),e.then(function(){setTimeout(function(){document.body.contains(t)?(rangeTake.el.remove(),t.remove(),buttonRefill.init()):t.removeAttribute("disabled")},300)})},ignoreRecommendedDose:function(e){var t=SETTINGS.PRESCRIPTION_DOSE_MIN,n=SETTINGS.PRESCRIPTION_DOSE_MAX,a=(SETTINGS.PRESCRIPTION_QTY_MIN,SETTINGS.PRESCRIPTION_QTY_MAX);buttonTake.state.ignoreRecommendedDose=!0,buttonTake.state.newDose=e<t?t:e>a?a:e>=t&&e<=n?Math.max(Math.round(e),t):prescription.dose},resetToOriginalDose:function(){delete buttonTake.state.ignoreRecommendedDose,delete buttonTake.state.newDose},addEvents:function(){var e=buttonTake.el,t=buttonTake.state,n=buttonTake.resetToOriginalDose;e.removeAttribute("disabled"),e.addEventListener("touchstart",function(e){delete t.ignoreDefaultAction,t.timer=setTimeout(function(){t.ignoreDefaultAction=!0,e.target.blur(),rangeTake.toggle()},350)},!1),e.addEventListener("touchend",function(e){e.preventDefault(),clearTimeout(t.timer),delete t.timer,t.ignoreDefaultAction||(t.ignoreRecommendedDose?(pillCollection.take(t.newDose),n()):pillCollection.take(prescription.dose),e.target.focus()),delete t.ignoreDefaultAction},!1),e.addEventListener("touchcancel",function(){clearTimeout(t.timer),delete t.timer,delete t.ignoreDefaultAction},!1)},data:function(){var e=document.createElement("button");e.className="capunder-take",e.type="button",e.name="take";var t=document.createDocumentFragment(),n=document.createElement("img");return n.src="dist/assets/image/material-arrow-drop-up.svg",n.alt="up arrow",t.appendChild(document.createTextNode("take")),t.appendChild(document.createTextNode(" ")),t.appendChild(n),e.appendChild(t),e},init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";buttonTake.el=buttonTake.data(),"disabled"===e?buttonTake.el.disabled=!0:buttonTake.addEvents(),capunderAction.el.appendChild(buttonTake.el)}};capunderAction.init(),buttonTake.init(),rangeTake.init();var label={el:document.getElementById("label"),parent:document.getElementById("label-wrapper"),state:{},resetTransform:function(){var e=label.parent.scrollLeft-window.outerWidth;label.el.style.transform="translate3d(".concat(e,"px, 0, 0)")},toggle:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=label.el,a=label.parent,o=label.state,i=a.scrollLeft,r=i-window.outerWidth;n.style.animationDelay="".concat(t,"ms"),"show"===e?(o.locked=!0,a.classList.add("locked"),n.style.setProperty("--slideIn-end","".concat(r,"px")),n.classList.add("slideIn"),promiseAnimationEnd(n).then(function(){n.classList.remove("slideIn"),n.removeAttribute("style"),n.style.transform="translate3d(".concat(r,"px, 0, 0)")}),window.addEventListener("resize",label.resetTransform)):(delete o.locked,window.removeEventListener("resize",label.resetTransform),n.style.setProperty("--slideOut-start","".concat(r,"px")),n.style.setProperty("--slideOut-end","".concat(i,"px")),n.classList.add("slideOut"),promiseAnimationEnd(n).then(function(){n.classList.remove("slideOut"),n.removeAttribute("style"),a.scrollLeft=0,a.classList.remove("locked")}))},toggleInput:function(e){labelDose.toggle(e),labelQuantity.toggle(e)},exportInformation:function(){updatePrescription({quantity:labelQuantity.value()&&RegExp("^[0-9]*$").test(labelQuantity.value())?labelQuantity.value():labelQuantity.placeholderValue(),dose:labelDose.value()}),label.toggle(),labelQuantity.input(prescription.quantity),labelQuantity.inputPlaceholder(),labelDose.select(prescription.dose),labelDate.setDate(),label.toggleInput("disable")}},labelDate={el:document.getElementById("label-date-number"),getDate:function(){var e=new Date;return{month:e.getMonth(),day:e.getDate(),year:e.getFullYear()}},setDate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:labelDate.getDate(),t=labelDate.el;for(populateStorage("date",JSON.stringify(e));t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode("".concat(e.month+1,"-").concat("0".concat(e.day).slice(-2),"-").concat(e.year)))},init:function(){retrieveStorage("date")&&labelDate.setDate(JSON.parse(retrieveStorage("date")))}};labelDate.init();var labelDose={el:document.getElementById("label-dose"),value:function(){var e=labelDose.el;return e.options[e.selectedIndex].text},select:function(e){labelDose.el.selectedIndex=e-1},toggle:function(e){switch(e){case"enable":labelDose.el.removeAttribute("disabled");break;case"disable":labelDose.el.disabled=!0;break;default:labelDose.el.removeAttribute("disabled")}},init:function(){for(var e=labelDose.el,t=labelDose.select,n=labelDose.toggle,a=document.createDocumentFragment(),o=SETTINGS.PRESCRIPTION_DOSE_MIN;o<=SETTINGS.PRESCRIPTION_DOSE_MAX;o++){var i=document.createElement("option");i.appendChild(document.createTextNode(o)),i.value=o,a.appendChild(i)}e.appendChild(a),t(prescription.dose),n("disable")}};labelDose.init();var labelQuantity={el:document.getElementById("label-quantity"),elMax:document.getElementById("label-quantity-max"),elMaxNumber:document.getElementById("label-quantity-max-number"),state:{placeholder:prescription.quantity},value:function(){return labelQuantity.el.value},placeholderValue:function(){return labelQuantity.state.placeholder},input:function(e){labelQuantity.el.value=e},inputPlaceholder:function(e){labelQuantity.state.placeholder=e,labelQuantity.el.placeholder=e,e||(delete labelQuantity.state.placeholder,labelQuantity.el.removeAttribute("placeholder"))},inputMax:function(e){for(var t=labelQuantity.elMaxNumber;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))},toggle:function(e){var t=labelQuantity.el,n=(labelQuantity.elMax,labelQuantity.elMaxNumber,labelQuantity.value);labelQuantity.inputMax;switch(e){case"enable":t.removeAttribute("disabled"),t.setAttribute("max","999");break;case"disable":t.disabled=!0,t.setAttribute("max",n());break;default:t.removeAttribute("disabled"),t.setAttribute("max","999")}},addEvents:function(){var e=labelQuantity.el,t=labelQuantity.elMax,n=labelQuantity.value,a=labelQuantity.placeholderValue,o=labelQuantity.input,i=labelQuantity.inputPlaceholder,r=labelQuantity.inputMax;e.addEventListener("focus",function(){n()&&RegExp("^[0-9]*$").test(n())&&i(n()),o(""),r(SETTINGS.PRESCRIPTION_QTY_MAX),t.classList.add("visible")}),e.addEventListener("blur",function(){if(n()&&RegExp(/^\d*\.?\d*$/).test(n()))if(!RegExp("^[0-9]*$").test(n())||n()<SETTINGS.PRESCRIPTION_QTY_MIN||n()>SETTINGS.PRESCRIPTION_QTY_MAX){var e=Math.round(n());e<SETTINGS.PRESCRIPTION_QTY_MIN?(o(SETTINGS.PRESCRIPTION_QTY_MIN),i(SETTINGS.PRESCRIPTION_QTY_MIN)):e>SETTINGS.PRESCRIPTION_QTY_MAX?(o(SETTINGS.PRESCRIPTION_QTY_MAX),i(SETTINGS.PRESCRIPTION_QTY_MAX)):(o(e),i(e))}else i(n());else o(a());t.classList.remove("visible"),r(SETTINGS.PRESCRIPTION_QTY_MAX)})},init:function(){var e=labelQuantity.el,t=labelQuantity.input,n=(labelQuantity.inputMax,labelQuantity.toggle),a=labelQuantity.addEvents;e.setAttribute("max","999"),t(prescription.quantity),n("disable"),a()}};labelQuantity.init();var Pill=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"withdraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.el.style.transitionDelay="".concat(e,"ms"),this.el.classList.add("withdrawn"),this.el.style.setProperty("--z-rotation",getRandomInt(0,.5))}},{key:"drop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.el.style.animationDelay="".concat(e,"ms"),this.el.classList.add("easeOutBounce"),this.el}},{key:"init",value:function(){this.el=this.constructor.data()}}],[{key:"data",value:function(){var e=document.createElement("div");return e.className="pill",e.style.setProperty("--pill-rotation","".concat(getRandomInt(0,360),"deg")),e}}]),e}(),pillCollection={el:document.getElementById("pill-collection"),properties:{contents:[]},count:function(){return pillCollection.properties.contents.length},updatePillCount:function(){populateStorage("pillCount",Math.max(0,pillCollection.count()))},take:function(e){pillCollection.el;var t=pillCollection.properties.contents,n=pillCollection.updatePillCount,a=Math.min(t.length,e),o=[];cap.state.open||cap.remove();for(var i=0;i<a;i++){var r=t[t.length-1];r.withdraw(getRandomInt(0,25*i)),o.push(promiseTransitionEnd(r.el)),t.splice(t.length-1,1),n()}return bottle.prepare(Promise.all(o)),Promise.all(o)},fill:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=pillCollection.el,a=pillCollection.properties.contents,o=pillCollection.updatePillCount,i=t.drop,r=document.createDocumentFragment(),l=[],c=0;c<e;c++){var s=new Pill;a.push(s),s.init(),i?(r.appendChild(s.drop(50*c)),l.push(promiseAnimationEnd(s.el))):r.appendChild(s.el)}return n.appendChild(r),o(),bottle.prepare(),Promise.all(l)},refill:function(){buttonRefill.removeEvents();for(var e=pillCollection.el,t=pillCollection.fill;e.firstChild;)e.removeChild(e.firstChild);label.exportInformation(),t(prescription.quantity,{drop:!0}).then(function(){cap.replace(),promiseTransitionEnd(cap.el).then(buttonTake.addEvents)})},init:function(){retrieveStorage("pillCount")||populateStorage("pillCount",0),pillCollection.fill(retrieveStorage("pillCount"))}};pillCollection.init();