"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=n.length;return function(i){if("function"!=typeof i&&("object"!==_typeof(i)||null===i))throw new TypeError("Object.keys called on non-object");var a,r,l=[];for(a in i)e.call(i,a)&&l.push(a);if(t)for(r=0;r<o;r++)e.call(i,n[r])&&l.push(n[r]);return l}}()),Object.values=Object.values?Object.values:function(e){var t=Object.prototype.toString.call(e);if(null===e||void 0===e)throw new TypeError("Cannot convert undefined or null to object");if(~["[object String]","[object Object]","[object Array]","[object Function]"].indexOf(t)){if(Object.keys)return Object.keys(e).map(function(t){return e[t]});var n=[];for(var o in e)e.hasOwnProperty(o)&&n.push(e[o]);return n}return[]},function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(0,function(){function e(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){return t.reject(n)})})}function t(e){return!(!e||void 0===e.length)}function n(){}function o(e){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(e,this)}function i(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,o._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var o;try{o=n(e._value)}catch(e){return void r(t.promise,e)}a(t.promise,o)}else(1===e._state?a:r)(t.promise,e._value)})):e._deferreds.push(t)}function a(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==_typeof(t)||"function"==typeof t)){var n=t.then;if(t instanceof o)return e._state=3,e._value=t,void l(e);if("function"==typeof n)return void c(function(e,t){return function(){e.apply(t,arguments)}}(n,t),e)}e._state=1,e._value=t,l(e)}catch(t){r(e,t)}}function r(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;n>t;t++)i(e,e._deferreds[t]);e._deferreds=null}function c(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,r(t,e))})}catch(e){if(n)return;n=!0,r(t,e)}}var s=setTimeout;o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var o=new this.constructor(n);return i(this,new function(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(e,t,o)),o},o.prototype.finally=e,o.all=function(e){return new o(function(n,o){function i(e,t){try{if(t&&("object"==_typeof(t)||"function"==typeof t)){var l=t.then;if("function"==typeof l)return void l.call(t,function(t){i(e,t)},o)}a[e]=t,0==--r&&n(a)}catch(e){o(e)}}if(!t(e))return o(new TypeError("Promise.all accepts an array"));var a=Array.prototype.slice.call(e);if(0===a.length)return n([]);for(var r=a.length,l=0;a.length>l;l++)i(l,a[l])})},o.resolve=function(e){return e&&"object"==_typeof(e)&&e.constructor===o?e:new o(function(t){t(e)})},o.reject=function(e){return new o(function(t,n){n(e)})},o.race=function(e){return new o(function(n,i){if(!t(e))return i(new TypeError("Promise.race accepts an array"));for(var a=0,r=e.length;r>a;a++)o.resolve(e[a]).then(n,i)})},o._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){s(e,0)},o._unhandledRejectionFn=function(e){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var u=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("unable to locate global object")}();"Promise"in u?u.Promise.prototype.finally||(u.Promise.prototype.finally=e):u.Promise=o}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){null!==this.parentNode&&this.parentNode.removeChild(this)}})}),function(){function e(){var e=[];this.touchList=e,this.Touch=function(e,t,n,o,i,a,r,l){this.identifier=e,this.target=t,this.screenX=n,this.screenY=o,this.clientX=i,this.clientY=a,this.pageX=r,this.pageY=l},this.getTouch=function(t){var n;for(n=0;n<e.length;n+=1)if(e[n].identifier===t)return e[n]},this.addUpdateTouch=function(t){var n;for(n=0;n<e.length;n+=1)if(e[n].identifier===t.identifier)return void(e[n]=t);e.push(t)},this.removeTouch=function(t){var n;for(n=0;n<e.length;n+=1)e[n].identifier===t&&e.splice(n,1)},this.clearTouches=function(){for(;e.length>0;)e.pop()},this.containsTouchAt=function(t,n){var o;for(o=0;o<e.length;o+=1)if(e[o].screenX===t&&e[o].screenY===n)return!0;return!1}}function t(e,t){return e.screenX===t.screenX&&e.screenY===t.screenY}function n(e,t){var n;return t=t||{bubbles:!1,cancelable:!1,detail:void 0},(n=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}function o(e,o,i,a,r){function l(e,t){var n,o;for(m.clearTouches(),n=0;n<t.length;n++)(o=t[n]).target.isSameNode(e)&&m.addUpdateTouch(o)}var c,s,u;"pointerdown"!==e.type&&(s=h.getTouch(e.pointerId),u=s.target,e.target=u),(c="pointerdown"===e.type||"pointermove"===e.type?function(e){var o,i,a;if(f("touch!"),"pointerdown"===e.type)o="touchstart";else{if("pointermove"!==e.type)throw new Error("touchHandler received invalid event type: "+o+". Valid event types are pointerdown and pointermove");o="touchmove"}return f(o),i=new h.Touch(e.pointerId,"pointerdown"===e.type?e.target:u,e.screenX,e.screenY,e.clientX,e.clientY,e.pageX,e.pageY),e.hwTimestamp>b&&function(){var e,n,o,i,a;for(n=v.touchList,e=0;e<n.length;e+=1)a=(o=n[e]).identifier,(i=h.getTouch(a))&&!t(i,o)||v.removeTouch(a)}(),f("generating touch cloned"),h.addUpdateTouch(i),v.addUpdateTouch(i),l(i.target,h.touchList),e.type=o,(a=new n(o,{bubbles:!0,cancelable:!0})).touches=h.touchList,a.changedTouches=v.touchList,a.targetTouches=m.touchList,a.type=o,a}(e):function(e){var t,o,i;return f("touchchanged!"),e.changedTouches=[],e.changedTouches.length=1,e.changedTouches[0]=e,e.changedTouches[0].identifier=e.pointerId,"pointerup"===e.type?t="touchend":"pointercancel"===e.type?t="touchcancel":"pointerleave"===e.type&&(t="touchleave"),o=new h.Touch(e.pointerId,u,e.screenX,e.screenY,e.clientX,e.clientY,e.pageX,e.pageY),e.hwTimestamp>b&&v.clearTouches(),h.removeTouch(o.identifier),v.addUpdateTouch(o),l(o.target,h.touchList),e.type=t,(i=new n(t,{bubbles:!0,cancelable:!0})).touches=h.touchList,i.changedTouches=v.touchList,i.targetTouches=m.touchList,i.type=t,i}(e)).preventDefault=function(){void 0!==e.preventDefault&&e.preventDefault()},f("dispatching!"),e.target.dispatchEvent(c),b=event.hwTimestamp}function i(e,t,n,i,a,r){o(t)}function a(e,t,n){var i,a;if(f("setTouchAware "+n+" "+t),e.__handJobjsGlobalRegisteredEvents||(e.__handJobjsGlobalRegisteredEvents=[]),n){if(void 0!==e.__handJobjsGlobalRegisteredEvents[t])return void(e.__handJobjsGlobalRegisteredEvents[t]+=1);e.__handJobjsGlobalRegisteredEvents[t]=1,f(e.__handJobjsGlobalRegisteredEvents[t])}else void 0!==e.__handJobjsGlobalRegisteredEvents[t]&&(e.__handJobjsGlobalRegisteredEvents[t]-=1,e.__handJobjsGlobalRegisteredEvents[t]<0&&(e.__handJobjsGlobalRegisteredEvents[t]=0));i=o,void 0!==e["on"+(a=function(e){return e}(t)).toLowerCase()]&&function(e,t,n,o){if(f("registerOrUnregisterEvent"),void 0===e.__handJobjsRegisteredEvents&&(e.__handJobjsRegisteredEvents=[]),o){if(void 0!==e.__handJobjsRegisteredEvents[t])return void(e.__handJobjsRegisteredEvents[t]+=1);e.__handJobjsRegisteredEvents[t]=1,f("adding event "+t),e.addEventListener(t,n,!1)}else{if(-1!==e.__handJobjsRegisteredEvents.indexOf(t)&&(e.__handJobjsRegisteredEvents[t]-=1,0!==e.__handJobjsRegisteredEvents[t]))return;f("removing event"),e.removeEventListener(t,n),e.__handJobjsRegisteredEvents[t]=0}}(e,a,function(e){i(e,t)},n)}function r(e){function t(e,t,o){f("customAddEventListener"),f(e),-1!==y.indexOf(e)&&(f("setting touch aware..."),a(this,e,!0)),n.call(this,e,t,o)}var n=e.prototype?e.prototype.addEventListener:e.addEventListener;f("intercepting add event listener!"),f(e),e.prototype?e.prototype.addEventListener=t:e.addEventListener=t}function l(e,t){f("handle other event"),e.preventManipulation&&e.preventManipulation(),o(touchPoint)}function c(e){function t(e,t,o){-1!==y.indexOf(e)&&function(e,t){if(void 0===e.ontouchdown&&void 0!==e.ontouchstart)switch(t.toLowerCase()){case"touchstart":e.removeEventListener("pointerdown",function(e){l(e)});break;case"touchmove":e.removeEventListener("pointermove",function(e){l(e)});break;case"touchend":e.removeEventListener("pointerup",function(e){l(e)});break;case"touchcancel":e.removeEventListener("pointercancel",function(e){l(e)})}}(this,e),n.call(this,e,t,o)}var n=e.prototype?e.prototype.removeEventListener:e.removeEventListener;e.prototype?e.prototype.removeEventListener=t:e.removeEventListener=t}function s(e,t){return f("checkEventRegistration"),e.__handJobjsGlobalRegisteredEvents&&e.__handJobjsGlobalRegisteredEvents[t]}function u(e,t,n,o,a,r){f("generateTouchEventProxyIfRegistered"),function(e,t){for(f("findEventRegisteredNode");e&&!s(e,t);)e=e.parentNode;return e||(s(window,t)?window:void 0)}(n,e)&&i(0,t)}function d(e){var t=[];if(e)for(t.unshift(e);e.parentNode;)t.unshift(e.parentNode),e=e.parentNode;return t}function p(e,t){for(var n=d(e),o=d(t),i=null;n.length>0&&n[0]===o.shift();)i=n.shift();return i}function f(e){g&&console.log(e.toString())}var h,v,m,b=0,g=!1,E=navigator.userAgent,y=["touchstart","touchmove","touchend","touchcancel","touchleave"],T={};n.prototype=window.Event.prototype,"object"!==_typeof(window.ontouchstart)&&(E.match(/iPad/i)||E.match(/iPhone/i)||E.match(/iPod/i)||E.match(/Android/i)||E.match(/MSIE/i)&&!E.match(/Touch/i)||(function(){var e="html { -ms-touch-action: none; }",t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n)}(),h=new e,v=new e,m=new e,window.CustomEvent=n,r(window),r(window.HTMLElement||window.Element),r(document),r(HTMLBodyElement),r(HTMLDivElement),r(HTMLImageElement),r(HTMLUListElement),r(HTMLAnchorElement),r(HTMLLIElement),r(HTMLTableElement),window.HTMLSpanElement&&r(HTMLSpanElement),window.HTMLCanvasElement&&r(HTMLCanvasElement),window.SVGElement&&r(SVGElement),c(window),c(window.HTMLElement||window.Element),c(document),c(HTMLBodyElement),c(HTMLDivElement),c(HTMLImageElement),c(HTMLUListElement),c(HTMLAnchorElement),c(HTMLLIElement),c(HTMLTableElement),window.HTMLSpanElement&&c(HTMLSpanElement),window.HTMLCanvasElement&&c(HTMLCanvasElement),window.SVGElement&&c(SVGElement),function(){function e(e){return"mouse"===e.pointerType||("pointerdown"===e.type&&0===e.x&&0===e.y||"pen"===e.pointerType&&0===e.pressure&&"pointermove"===e.type)}window.addEventListener("pointerdown",function(t){f("pointerdownfired");var n=t;e(t)||(T[n.identifier]=n.target,u("touchenter",n,n.target),function(e,t,n){f("dispatchPointerEnter");for(var o=p(e,t),i=e,a=[];i&&i!==o;)s(i,"touchenter")&&a.push(i),i=i.parentNode;for(;a.length>0;)n(a.pop())}(n.target,null,function(e){i(0,n)}),u("touchstart",n,n.target))}),window.addEventListener("pointerup",function(t){var n=t,o=T[n.identifier];f("pointer up fired"),e(t)||(u("touchend",n,o),u("touchleave",n,o),function(e,t,n){f("dispatchPointerLeave");for(var o=p(e,t),i=e;i&&i!==o;)s(i,"touchleave")&&n(i),i=i.parentNode}(o,null,function(e){i(0,n)}))}),window.addEventListener("pointermove",function(t){var n=t,o=T[n.identifier];f("pointer move fired"),e(t)||(f("x: "+t.screenX+", y: "+t.screenY),h.containsTouchAt(t.screenX,t.screenY)||(o&&!0===function(e){for(;e&&!e.handJobjs_forcePreventDefault;)e=e.parentNode;return!!e||window.handJobjs_forcePreventDefault}(o)&&t.preventDefault(),u("touchmove",n,o)))})}()))}();var whichAnimationEvent=function(){for(var e=document.createElement("fakeelement"),t={animation:"animationend",OAnimation:"oTransitionEnd",MozAnimation:"animationend",WebkitAnimation:"webkitTransitionEnd"},n=0;n<Object.keys(t).length;n++)if(void 0!==e.style[Object.keys(t)[n]])return Object.values(t)[n]},animationend=whichAnimationEvent(),promiseAnimationEnd=function(e){return new Promise(function(t){e.addEventListener(animationend,t)})},whichTransitionEvent=function(){for(var e=document.createElement("fakeelement"),t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"},n=0;n<Object.keys(t).length;n++)if(void 0!==e.style[Object.keys(t)[n]])return Object.values(t)[n]},transitionend=whichTransitionEvent(),promiseTransitionEnd=function(e){return new Promise(function(t){e.addEventListener(transitionend,t)})},getRandomInt=function(e,t){return Math.floor(Math.random()*(Math.floor(t)-Math.ceil(e)))+Math.ceil(e)},getSizeOfElement=function(e,t){var n,o=document.createElement("div");switch(o.className=e,o.style.visibility="hidden",o.style.position="absolute",document.body.appendChild(o),t){case"width":n=o.getBoundingClientRect().width;break;case"height":n=o.getBoundingClientRect().height;break;default:n=o.getBoundingClientRect().width}return o.remove(),n},getWidthOfElement=function(e){return getSizeOfElement(e,"width")},getHeightOfElement=function(e){return getSizeOfElement(e,"height")},storageAvailable=function(e){var t;try{t=window[e];var n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}},populateStorage=function(e,t){storageAvailable("localStorage")&&localStorage.setItem(e,t)},retrieveStorage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return storageAvailable("localStorage")?localStorage.getItem(e):t},removeStorage=function(e){storageAvailable("localStorage")&&localStorage.removeItem(e)},GLOBAL={WIDTH:window.outerWidth,HEIGHT:window.innerHeight},setMaximumCapacity=function(){return Math.ceil(GLOBAL.WIDTH/getWidthOfElement("pill transformedWidthTest")*(.8*GLOBAL.HEIGHT/getWidthOfElement("pill transformedWidthTest")))},SETTINGS={PRESCRIPTION_DOSE_MIN:1,PRESCRIPTION_DOSE_MAX:5,PRESCRIPTION_QTY_MIN:1,PRESCRIPTION_QTY_MAX:setMaximumCapacity()};window.addEventListener("contextmenu",function(e){e.preventDefault()}),window.addEventListener("resize",function(){GLOBAL.WIDTH=window.outerWidth,GLOBAL.HEIGHT=window.innerHeight,SETTINGS.PRESCRIPTION_QTY_MAX=setMaximumCapacity()}),window.addEventListener("orientationchange",function(){GLOBAL.WIDTH=window.outerWidth,GLOBAL.HEIGHT=window.innerHeight,SETTINGS.PRESCRIPTION_QTY_MAX=setMaximumCapacity()});var prescription={};SETTINGS.DEFAULT_PRESCRIPTION=JSON.stringify({quantity:Math.min(15,SETTINGS.PRESCRIPTION_QTY_MAX),dose:1}),retrieveStorage("prescription")||populateStorage("prescription",SETTINGS.DEFAULT_PRESCRIPTION);var updatePrescription=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.quantity,o=e.dose,i=t.skipValidation,a=SETTINGS.DEFAULT_PRESCRIPTION,r=SETTINGS.PRESCRIPTION_DOSE_MIN,l=SETTINGS.PRESCRIPTION_DOSE_MAX,c=SETTINGS.PRESCRIPTION_QTY_MIN,s=SETTINGS.PRESCRIPTION_QTY_MAX,u=JSON.parse(a);i?(prescription.dose=o,prescription.quantity=n):(prescription.dose=o<r?r:o>s?s:o>=r&&o<=l?Math.max(Math.round(o),r):u.dose,prescription.quantity=n<c?c:n>s?s:n>=c&&n<=s?Math.max(prescription.dose,Math.round(n)):u.quantity),populateStorage("prescription",JSON.stringify(prescription))};updatePrescription(JSON.parse(retrieveStorage("prescription",SETTINGS.DEFAULT_PRESCRIPTION)),{skipValidation:!0});var bottle={el:document.getElementById("bottle"),state:{capacity:"full"},setOpenState:function(e){bottle.state.capacity="fromStorage"===e?retrieveStorage("pillCount")>0?"full":"empty":pillCollection.count()>0?"full":"empty"},prepare:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();switch(bottle.setOpenState(),bottle.state.capacity){case"empty":buttonTake.toggle(e),label.toggleInput("enable"),e.then(function(){label.toggle("show",150)});break;case"full":buttonRefill.toggle()}},empty:function(){bottle.el.classList.add("flipped"),pillCollection.take(pillCollection.count()).then(function(){promiseTransitionEnd(bottle.el).then(function(){setTimeout(function(){bottle.el.classList.remove("flipped")},300)})})},init:function(){bottle.setOpenState("fromStorage")}};bottle.init();var cap={properties:{width:0,height:0},state:{timer:0,clientX:0,clientY:0,deltaX:0,deltaY:0},setOpenState:function(e){cap.state.open="open"===e,populateStorage("capState",e)},depress:function(){cap.state.action="depressed",cap.el.classList.add("pressed")},move:function(){cap.state.action="dragging",cap.el.classList.add("dragging")},reset:function(){delete cap.state.action,cap.el.classList.remove("pressed","dragging"),cap.el.removeAttribute("style")},remove:function(){cap.state.action="dragged",cap.el.classList.add("dragged"),cap.setOpenState("open")},replace:function(){delete cap.state.action,cap.el.classList.remove("dragged"),cap.setOpenState("closed")},addEvents:function(){var e=cap.el,t=cap.properties,n=cap.state,o=cap.depress,i=cap.move,a=cap.reset,r=cap.remove,l=(cap.replace,t.width),c=t.height,s=n.timer,u=n.clientX,d=n.clientY,p=n.deltaX,f=n.deltaY;l=e.offsetWidth,c=e.offsetHeight,window.addEventListener("resize",function(){l=e.offsetWidth,c=e.offsetHeight}),window.addEventListener("orientationchange",function(){l=e.offsetWidth,c=e.offsetHeight}),e.addEventListener("touchstart",function(e){var t=e.touches;e.preventDefault(),u=t[0].clientX,d=t[0].clientY,s=setTimeout(o,250)},!1),e.addEventListener("touchmove",function(e){var t=e.target,o=e.touches;if(s&&clearTimeout(s),"depressed"===n.action||"dragging"===n.action){i(),p=o[0].clientX-u,f=o[0].clientY-d;var a=Math.max(-f/l,p/l);t.style.setProperty("--cap-rotate","".concat(a>0?Math.max(0,80*a):0,"deg")),t.style.setProperty("--cap-translate","".concat(f<0?Math.max(-40,f/4):0,"%"))}},!1),e.addEventListener("touchend",function(e){s&&clearTimeout(s),("dragging"===n.action&&p>=l/2.5||-f>=c/2.5)&&r(),a(),p=0,f=0},!1),e.addEventListener("touchcancel",function(e){s&&clearTimeout(s),a()},!1)},data:function(){var e=document.createElement("div");e.className="cap";for(var t=document.createDocumentFragment(),n=0;n<=12;n++){var o=document.createElement("div");o.className="cap-indent",t.appendChild(o)}return e.appendChild(t),e},init:function(){switch(cap.el=cap.data(),retrieveStorage("capState")){case"open":cap.remove();break;case"closed":break;default:cap.remove()}document.getElementById("top").appendChild(cap.el),cap.addEvents()}};cap.init();var capunder={data:function(){var e=document.createElement("section");return e.className="capunder",e},init:function(){capunder.el=capunder.data(),document.getElementById("top").appendChild(capunder.el)}};capunder.init();var capunderAction={data:function(){var e=document.createElement("div");return e.className="capunder-action",e},init:function(){capunderAction.el=capunderAction.data(),capunder.el.appendChild(capunderAction.el)}},buttonClose={addEvents:function(){buttonClose.el.addEventListener("touchend",function(e){cap.replace()},!1)},data:function(){var e=document.createElement("button");e.className="capunder-close",e.type="button",e.name="close";var t=document.createElement("img");return t.src="dist/assets/image/open-collapse-down.svg",t.alt="close",e.appendChild(t),e},init:function(){buttonClose.el=buttonClose.data(),buttonClose.addEvents(),capunder.el.appendChild(buttonClose.el)}};buttonClose.init();var capunderMenu={data:function(){var e=document.createElement("ul");return e.className="capunder-menu",e},init:function(){capunderMenu.el=capunderMenu.data(),capunderAction.el.appendChild(capunderMenu.el)}},buttonRefill={toggle:function(){var e=buttonRefill.el;document.body.contains(e)&&(e.remove(),buttonTake.init("disabled"))},addEvents:function(){buttonRefill.el.addEventListener("touchend",pillCollection.refill,!1)},removeEvents:function(){buttonRefill.el.removeEventListener("touchend",pillCollection.refill,!1)},data:function(){var e=document.createElement("button");e.className="capunder-refill",e.type="button",e.name="refill";var t=document.createDocumentFragment(),n=document.createElement("img");return n.src="dist/assets/image/material-arrow-drop-down.svg",n.alt="down arrow",t.appendChild(document.createTextNode("refill")),t.appendChild(document.createTextNode(" ")),t.appendChild(n),e.appendChild(t),e},init:function(){buttonRefill.el=buttonRefill.data(),buttonRefill.addEvents(),capunderAction.el.appendChild(buttonRefill.el)}},buttonTake={toggle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve(),t=buttonTake.el;t.disabled=!0,e.then(function(){setTimeout(function(){document.body.contains(t)?(t.remove(),buttonRefill.init()):t.removeAttribute("disabled")},300)})},addEvents:function(){var e=buttonTake.el;e.removeAttribute("disabled"),e.addEventListener("touchend",function(e){pillCollection.take(prescription.dose)},!1)},data:function(){var e=document.createElement("button");e.className="capunder-take",e.type="button",e.name="take";var t=document.createDocumentFragment(),n=document.createElement("img");return n.src="dist/assets/image/material-arrow-drop-up.svg",n.alt="up arrow",t.appendChild(document.createTextNode("take")),t.appendChild(document.createTextNode(" ")),t.appendChild(n),e.appendChild(t),e},init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";buttonTake.el=buttonTake.data(),"disabled"===e?buttonTake.el.disabled=!0:buttonTake.addEvents(),capunderAction.el.appendChild(buttonTake.el)}};capunderAction.init(),buttonTake.init();var label={el:document.getElementById("label"),parent:document.getElementById("label-wrapper"),state:{},toggle:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=label.el,o=label.parent,i=label.state,a=o.scrollLeft;n.style.animationDelay="".concat(t,"ms"),"show"===e?(i.locked=!0,o.classList.add("locked"),n.style.setProperty("--slideIn-end","".concat(a-GLOBAL.WIDTH,"px")),n.classList.add("slideIn")):(delete i.locked,n.style.setProperty("--slideOut-start","".concat(a-GLOBAL.WIDTH,"px")),n.style.setProperty("--slideOut-end","".concat(a,"px")),n.classList.add("slideOut"),promiseAnimationEnd(n).then(function(){n.classList.remove("slideIn","slideOut"),n.removeAttribute("style"),o.scrollLeft=0,o.classList.remove("locked")}))},toggleInput:function(e){labelDose.toggle(e),labelQuantity.toggle(e)},exportInformation:function(){updatePrescription({quantity:labelQuantity.value()&&RegExp("^[0-9]*$").test(labelQuantity.value())?labelQuantity.value():labelQuantity.placeholderValue(),dose:labelDose.value()}),label.toggle(),labelQuantity.input(prescription.quantity),labelQuantity.inputPlaceholder(),labelDose.select(prescription.dose),labelDate.setDate(),label.toggleInput("disable")},addEvents:function(){window.addEventListener("resize",function(){label.state.locked&&window.requestAnimationFrame(function(){label.el.style.setProperty("--slideIn-end","".concat(label.parent.scrollLeft-GLOBAL.WIDTH,"px"))})}),window.addEventListener("orientationchange",function(){label.state.locked&&window.requestAnimationFrame(function(){label.el.style.setProperty("--slideIn-end","".concat(label.parent.scrollLeft-GLOBAL.WIDTH,"px"))})})},init:function(){label.addEvents()}};label.init();var labelDate={el:document.getElementById("label-date-number"),getDate:function(){var e=new Date;return{month:e.getMonth(),day:e.getDate(),year:e.getFullYear()}},setDate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:labelDate.getDate(),t=labelDate.el;for(populateStorage("date",JSON.stringify(e));t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode("".concat(e.month+1,"-").concat("0".concat(e.day).slice(-2),"-").concat(e.year)))},init:function(){retrieveStorage("date")&&labelDate.setDate(JSON.parse(retrieveStorage("date")))}};labelDate.init();var labelDose={el:document.getElementById("label-dose"),value:function(){var e=labelDose.el;return e.options[e.selectedIndex].text},select:function(e){labelDose.el.selectedIndex=e-1},toggle:function(e){switch(e){case"enable":labelDose.el.removeAttribute("disabled");break;case"disable":labelDose.el.disabled=!0;break;default:labelDose.el.removeAttribute("disabled")}},init:function(){for(var e=labelDose.el,t=labelDose.select,n=labelDose.toggle,o=document.createDocumentFragment(),i=SETTINGS.PRESCRIPTION_DOSE_MIN;i<=SETTINGS.PRESCRIPTION_DOSE_MAX;i++){var a=document.createElement("option");a.appendChild(document.createTextNode(i)),a.value=i,o.appendChild(a)}e.appendChild(o),t(prescription.dose),n("disable")}};labelDose.init();var labelQuantity={el:document.getElementById("label-quantity"),elMax:document.getElementById("label-quantity-max"),elMaxNumber:document.getElementById("label-quantity-max-number"),state:{placeholder:prescription.quantity},value:function(){return labelQuantity.el.value},placeholderValue:function(){return labelQuantity.state.placeholder},input:function(e){labelQuantity.el.value=e},inputPlaceholder:function(e){labelQuantity.state.placeholder=e,labelQuantity.el.placeholder=e,e||(delete labelQuantity.state.placeholder,labelQuantity.el.removeAttribute("placeholder"))},inputMax:function(e){for(var t=labelQuantity.elMaxNumber;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))},toggle:function(e){var t=labelQuantity.el,n=(labelQuantity.elMax,labelQuantity.elMaxNumber,labelQuantity.value);labelQuantity.inputMax;switch(e){case"enable":t.removeAttribute("disabled"),t.setAttribute("max","999");break;case"disable":t.disabled=!0,t.setAttribute("max",n());break;default:t.removeAttribute("disabled"),t.setAttribute("max","999")}},addEvents:function(){var e=labelQuantity.el,t=labelQuantity.elMax,n=labelQuantity.value,o=labelQuantity.placeholderValue,i=labelQuantity.input,a=labelQuantity.inputPlaceholder,r=labelQuantity.inputMax;e.addEventListener("focus",function(){n()&&RegExp("^[0-9]*$").test(n())&&a(n()),i(""),r(SETTINGS.PRESCRIPTION_QTY_MAX),t.classList.add("visible")}),e.addEventListener("blur",function(){if(n()&&RegExp(/^\d*\.?\d*$/).test(n()))if(!RegExp("^[0-9]*$").test(n())||n()<SETTINGS.PRESCRIPTION_QTY_MIN||n()>SETTINGS.PRESCRIPTION_QTY_MAX){var e=Math.round(n());e<SETTINGS.PRESCRIPTION_QTY_MIN?(i(SETTINGS.PRESCRIPTION_QTY_MIN),a(SETTINGS.PRESCRIPTION_QTY_MIN)):e>SETTINGS.PRESCRIPTION_QTY_MAX?(i(SETTINGS.PRESCRIPTION_QTY_MAX),a(SETTINGS.PRESCRIPTION_QTY_MAX)):(i(e),a(e))}else a(n());else i(o());t.classList.remove("visible"),r(SETTINGS.PRESCRIPTION_QTY_MAX)})},init:function(){var e=labelQuantity.el,t=labelQuantity.input,n=(labelQuantity.inputMax,labelQuantity.toggle),o=labelQuantity.addEvents;e.setAttribute("max","999"),t(prescription.quantity),n("disable"),o()}};labelQuantity.init();var Pill=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"withdraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.el.style.transitionDelay="".concat(e,"ms"),this.el.classList.add("withdrawn"),this.el.style.setProperty("--z-rotation",getRandomInt(0,.5))}},{key:"drop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.el.style.animationDelay="".concat(e,"ms"),this.el.classList.add("easeOutBounce"),this.el}},{key:"init",value:function(){this.el=this.constructor.data()}}],[{key:"data",value:function(){var e=document.createElement("div");return e.className="pill",e.style.setProperty("--pill-rotation","".concat(getRandomInt(0,360),"deg")),e}}]),e}(),pillCollection={el:document.getElementById("pill-collection"),properties:{contents:[]},count:function(){return pillCollection.properties.contents.length},updatePillCount:function(){populateStorage("pillCount",Math.max(0,pillCollection.count()))},take:function(e){pillCollection.el;var t=pillCollection.properties.contents,n=pillCollection.updatePillCount,o=Math.min(t.length,e),i=[];cap.state.open||cap.remove();for(var a=0;a<o;a++){var r=t[t.length-1];r.withdraw(getRandomInt(0,25*a)),i.push(promiseTransitionEnd(r.el)),t.splice(t.length-1,1),n()}return bottle.prepare(Promise.all(i)),Promise.all(i)},fill:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=pillCollection.el,o=pillCollection.properties.contents,i=pillCollection.updatePillCount,a=t.drop,r=document.createDocumentFragment(),l=[],c=0;c<e;c++){var s=new Pill;o.push(s),s.init(),a?(r.appendChild(s.drop(50*c)),l.push(promiseAnimationEnd(s.el))):r.appendChild(s.el)}return n.appendChild(r),i(),bottle.prepare(),Promise.all(l)},refill:function(){buttonRefill.removeEvents();for(var e=pillCollection.el,t=pillCollection.fill;e.firstChild;)e.removeChild(e.firstChild);label.exportInformation(),t(prescription.quantity,{drop:!0}).then(function(){cap.replace(),promiseTransitionEnd(cap.el).then(buttonTake.addEvents)})},init:function(){retrieveStorage("pillCount")||populateStorage("pillCount",0),pillCollection.fill(retrieveStorage("pillCount"))}};pillCollection.init();