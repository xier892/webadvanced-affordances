"use strict";var getRandomInt=function(e,t){return Math.floor(Math.random()*(Math.floor(t)-Math.ceil(e)))+Math.ceil(e)},storageAvailable=function(e){var t;try{t=window[e];var n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}},populateStorage=function(e,t){storageAvailable("localStorage")&&localStorage.setItem(e,t)},retrieveStorage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return storageAvailable("localStorage")?localStorage.getItem(e):t},removeStorage=function(e){storageAvailable("localStorage")&&localStorage.removeItem(e)},vh=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(vh,"px")),window.addEventListener("contextmenu",function(e){e.preventDefault()});var prescription={},defaultPrescription=JSON.stringify({quantity:15,dose:1});null===retrieveStorage("prescription")&&populateStorage("prescription",defaultPrescription);var updatePrescription=function(e){var t=e.quantity,n=e.dose;prescription.quantity=t,prescription.dose=n,populateStorage("prescription",JSON.stringify(e))};updatePrescription(JSON.parse(retrieveStorage("prescription",defaultPrescription)));var pill={data:function(){var e=document.createElement("div");return e.className="pill",e.style.setProperty("--pill-rotation","".concat(getRandomInt(0,360),"deg")),e},withdraw:function(){var e=this;this.el.className="pill",this.el.style.transform="translateY(100vh) rotate3d(1, 0, ".concat(getRandomInt(0,.5),", 90deg)"),setTimeout(function(){e.el.remove()},300)},init:function(){var e=this;this.el=this.data(),this.el.classList.add("easeOutBounce"),setTimeout(function(){e.el.classList.remove("easeOutBounce")},2e3)}},Pill=function(){return Object.create(pill)},cap={data:function(){var e=document.createElement("div");e.className="cap";for(var t=document.createDocumentFragment(),n=0;n<=12;n++){var a=document.createElement("div");a.className="cap-indent",t.appendChild(a)}return e.appendChild(t),e},properties:{width:0,height:0},state:{timer:0,clientX:0,clientY:0,deltaX:0,deltaY:0},depress:function(){cap.el.classList.add("pressed")},move:function(){cap.el.classList.remove("pressed"),cap.el.classList.add("dragging")},reset:function(){cap.el.classList.remove("pressed","dragging"),cap.el.removeAttribute("style")},remove:function(){cap.el.classList.add("dragged"),populateStorage("capState","open")},replace:function(){cap.el.classList.remove("dragged"),removeStorage("capState")},addEvents:function(){var e=cap.el,t=cap.depress,n=cap.move,a=cap.reset,o=cap.remove,i=(cap.replace,cap.properties),l=i.width,r=i.height,c=cap.state,d=c.timer,s=c.clientX,u=c.clientY,p=c.deltaX,m=c.deltaY;l=e.offsetWidth,r=e.offsetHeight,window.addEventListener("orientationchange",function(){l=e.offsetWidth,r=e.offsetHeight}),e.addEventListener("touchstart",function(e){var n=e.touches;e.preventDefault(),s=n[0].clientX,u=n[0].clientY,d=setTimeout(t,250)},!1),e.addEventListener("touchmove",function(e){var t=e.target,a=e.touches;if(d&&clearTimeout(d),t.classList.contains("pressed")||t.classList.contains("dragging")){n(),p=a[0].clientX-s,m=a[0].clientY-u;var o=Math.max(-m/l,p/l);t.style.setProperty("--cap-rotate","".concat(o>0?Math.max(0,80*o):0,"deg")),t.style.setProperty("--cap-translate","".concat(m<0?Math.max(-40,m/4):0,"%"))}},!1),e.addEventListener("touchend",function(e){var t=e.target;d&&clearTimeout(d),(t.classList.contains("dragging")&&p>=l/2.5||-m>=r/2.5)&&o(),a(),p=0,m=0},!1),e.addEventListener("touchcancel",function(e){d&&clearTimeout(d),a()},!1)},init:function(){switch(cap.el=cap.data(),document.getElementById("top").insertBefore(cap.el,document.getElementById("capunder")),retrieveStorage("capState")){case"open":cap.remove()}cap.addEvents()}};cap.init();var capunder={data:function(){var e=document.createElement("section");return e.className="capunder",e},state:"full",setState:function(){capunder.state=retrieveStorage("pillCount")>0?"full":"empty"},toggleButton:function(){switch(capunder.setState(),capunder.state){case"empty":buttonTake.toggle();break;case"full":buttonRefill.toggle()}},init:function(){capunder.setState(),capunder.el=capunder.data(),document.getElementById("top").appendChild(capunder.el)}};capunder.init();var buttonClose={data:function(){var e=document.createElement("button");e.className="capunder-close",e.type="button",e.name="close";var t=document.createElement("img");return t.src="dist/assets/image/open-collapse-down.svg",t.alt="close",e.appendChild(t),e},addEvents:function(){buttonClose.el.addEventListener("touchend",function(e){cap.replace()},!1)},init:function(){buttonClose.el=buttonClose.data(),capunder.el.appendChild(buttonClose.el),buttonClose.addEvents()}};buttonClose.init();var buttonRefill={data:function(){var e=document.createElement("button");e.className="capunder-refill",e.type="button",e.name="refill";var t=document.createDocumentFragment(),n=document.createElement("img");return n.src="dist/assets/image/material-arrow-drop-down.svg",n.alt="down arrow",t.appendChild(document.createTextNode("refill")),t.appendChild(document.createTextNode(" ")),t.appendChild(n),e.appendChild(t),e},toggle:function(){var e=buttonRefill.el;document.body.contains(e)&&(e.remove(),buttonTake.init())},addEvents:function(){buttonRefill.el.addEventListener("touchend",function(e){pillCollection.refill()},!1)},init:function(){buttonRefill.el=buttonRefill.data(),capunder.el.appendChild(buttonRefill.el),buttonRefill.addEvents()}},buttonTake={data:function(){var e=document.createElement("button");e.className="capunder-take",e.type="button",e.name="take";var t=document.createDocumentFragment(),n=document.createElement("img");return n.src="dist/assets/image/material-arrow-drop-up.svg",n.alt="up arrow",t.appendChild(document.createTextNode("take")),t.appendChild(document.createTextNode(" ")),t.appendChild(n),e.appendChild(t),e},toggle:function(){var e=buttonTake.el;document.body.contains(e)&&(e.remove(),buttonRefill.init())},addEvents:function(){buttonTake.el.addEventListener("touchend",function(e){pillCollection.take(prescription.dose)},!1)},init:function(){buttonTake.el=buttonTake.data(),capunder.el.appendChild(buttonTake.el),buttonTake.addEvents()}};buttonTake.init();var pillCollection={el:document.getElementById("pill-collection"),properties:{contents:[]},take:function(e){pillCollection.el;for(var t=pillCollection.properties.contents,n=1;n<=e;n++)t[t.length-n].withdraw();t.splice(t.length-e,e),populateStorage("pillCount",Math.max(0,retrieveStorage("pillCount")-e)),capunder.toggleButton()},fill:function(e){for(var t=pillCollection.el,n=pillCollection.properties.contents,a=function(e){var a=new Pill;a.init(),n.push(a),setTimeout(function(){t.appendChild(a.el)},50*e)},o=0;o<e;o++)a(o);populateStorage("pillCount",n.length),capunder.toggleButton()},refill:function(){pillCollection.fill(prescription.quantity)},init:function(){null===retrieveStorage("pillCount")&&populateStorage("pillCount",prescription.quantity),pillCollection.fill(retrieveStorage("pillCount"))}};pillCollection.init();